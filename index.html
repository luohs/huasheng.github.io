<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="ä¸‰å‘³çŒªå±‹">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="ä¸‰å‘³çŒªå±‹">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ä¸‰å‘³çŒªå±‹">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title> ä¸‰å‘³çŒªå±‹ </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">ä¸‰å‘³çŒªå±‹</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/14/20170614/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="èŠ±ç”Ÿ-sniper">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸‰å‘³çŒªå±‹">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸‰å‘³çŒªå±‹" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/14/20170614/" itemprop="url">
                  æ¶ˆé™¤ç¬¬ä¸‰æ–¹libraryè­¦å‘Š
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-14T16:41:18+08:00">
                2017-06-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/clang/" itemprop="url" rel="index">
                    <span itemprop="name">clang</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><p>é›†æˆç¬¬ä¸‰æ–¹åº“çš„æ—¶å€™ç»å¸¸ä¼šæŠ¥ä¸€äº›è­¦å‘Šï¼Œå¦‚ï¼š<br>1ã€<code>unable to open object file: No such file or directory</code><br><img src="/images/20170614/warning_1.png" alt=""><br>å› ä¸ºåœ¨buildé™æ€libæ—¶ï¼ŒCLANG_ENABLE_MODULESæ²¡æœ‰è¢«è®¾ç½®æˆNOã€‚<br><img src="/images/20170614/clang_enable_modules.png" alt=""><br>è§£å†³åŠæ³•ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">1) Go to Build Settings -&gt; Build Options -&gt; Debug Information Format</div><div class="line">2) Change the Debug setting from &quot;DWARF with dSYM File&quot; to &quot;DWARF&quot;</div><div class="line">3) Leave the Release setting at &quot;DWARF with dSYM File&quot;</div></pre></td></tr></table></figure></p>
<p>ä½†æ˜¯è¿™ä¸æ˜¯æ ¹æœ¬è§£å†³åŠæ³•ï¼Œæ ¹æœ¬çš„è¿˜æ˜¯éœ€è¦é™æ€åº“æä¾›è€…å»æ¶ˆé™¤è¿™ä¸ªè­¦å‘Šã€‚</p>
<p>2ã€<code>ld: pointer not aligned at address 0x13735E9</code><br><img src="/images/20170614/warning_2.png" alt=""><br><img src="/images/20170614/warning_2_1.jpg" alt=""><br>è§£å†³åŠæ³•ï¼š<br><img src="/images/20170614/warning_2_solution.jpg" alt=""></p>
<p>å‚è€ƒï¼š<br><a href="https://pewpewthespells.com/blog/buildsettings.html#clang_enable_modules" target="_blank" rel="external">https://pewpewthespells.com/blog/buildsettings.html#clang_enable_modules</a><br><a href="https://stackoverflow.com/questions/42268117/how-to-remove-the-xcode-warning-apple-mach-o-linker-warning-pointer-not-aligned/43056194#43056194" target="_blank" rel="external">https://stackoverflow.com/questions/42268117/how-to-remove-the-xcode-warning-apple-mach-o-linker-warning-pointer-not-aligned/43056194#43056194</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/02/20170603/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="èŠ±ç”Ÿ-sniper">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸‰å‘³çŒªå±‹">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸‰å‘³çŒªå±‹" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/02/20170603/" itemprop="url">
                  iOSåŒ…å¤§å°ç˜¦èº«æ–¹æ¡ˆï¼ˆäºŒï¼‰- åŸºäºclangæ’ä»¶iOSç˜¦èº«å®è·µ
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-02T08:32:39+08:00">
                2017-06-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/app-thinning/" itemprop="url" rel="index">
                    <span itemprop="name">app-thinning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><p>clangä½œä¸ºLLVMæä¾›çš„ç¼–è¯‘å™¨å‰ç«¯ï¼Œå¯å°†ç”¨æˆ·çš„æºä»£ç (C/C++/Objective-C)ç¼–è¯‘æˆè¯­è¨€/ç›®æ ‡è®¾å¤‡æ— å…³çš„IR(Intermediate Representation)å®ç°ã€‚å…¶å¯æä¾›è‰¯å¥½çš„æ’ä»¶æ”¯æŒï¼Œå®¹è®¸ç”¨æˆ·åœ¨ç¼–è¯‘æ—¶ï¼Œè¿è¡Œé¢å¤–çš„è‡ªå®šä¹‰åŠ¨ä½œã€‚<br>æœ¬ç¯‡æ˜¯åŸºäºclangçš„æ’ä»¶ç‰¹æ€§ï¼Œç¼–å†™ä¸€ä¸ªclangæ’ä»¶ä½œä¸ºä¸€ä¸ªæºä»£ç çº§åˆ«çš„åˆ†æå·¥å…·(æˆ–ç¼–è¯‘å™¨)ç”Ÿæˆå„ç§ä¸­é—´æ–‡ä»¶ã€‚ç¼–è¯‘å®Œæˆåï¼Œè¿˜éœ€ç¼–å†™ä¸€ä¸ªå·¥å…·å»åˆ†ææ‰€æœ‰åŒ…å«æºç çš„æ–¹æ³•(åŒ…æ‹¬ç”¨æˆ·ç¼–å†™ï¼Œä»¥åŠå¼•å…¥çš„ç¬¬ä¸‰æ–¹åº“æºä»£ç )ï¼Œæ£€æŸ¥è¿™äº›æ–¹æ³•ä¸­å“ªäº›æœ€ç»ˆå¯è¢«ç¨‹åºä¸»å…¥å£è°ƒç”¨ï¼Œå‰©ä½™å³æ˜¯ç–‘ä¼¼æ— ç”¨ä»£ç ã€‚ä»è€Œåˆ†æå‡ºæºä»£ç ä¸­é‚£äº›ç¡®å®šæ— ç”¨çš„ä»£ç ï¼Œä¾¿å¯ä»¥æœ‰æ•ˆå»é™¤æ— ç”¨çš„ä»£ç ä»è€Œå‡å°‘åŒ…å¤§å°ã€‚<br>LLVMå·¥ç¨‹åŒ…å«äº†ä¸€ç»„æ¨¡å—åŒ–ï¼Œå¯å¤ç”¨çš„ç¼–è¾‘å™¨å’Œå·¥å…·é“¾ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">LLVM Core:åŒ…å«ä¸€ä¸ªç°åœ¨çš„æºä»£ç /ç›®æ ‡è®¾å¤‡æ— å…³çš„ä¼˜åŒ–å™¨ï¼Œä¸€é›†ä¸€ä¸ªé’ˆå¯¹å¾ˆå¤šä¸»æµ(ç”šè‡³äºä¸€äº›éä¸»æµ)çš„CPUçš„æ±‡ç¼–ä»£ç ç”Ÿæˆæ”¯æŒã€‚</div><div class="line">Clang:ä¸€ä¸ªC/C++/Objective-Cç¼–è¯‘å™¨ï¼Œè‡´åŠ›äºæä¾›ä»¤äººæƒŠè®¶çš„å¿«é€Ÿç¼–è¯‘ï¼Œæå…¶æœ‰ç”¨çš„é”™è¯¯å’Œè­¦å‘Šä¿¡æ¯ï¼Œæä¾›ä¸€ä¸ªå¯ç”¨äºæ„å»ºå¾ˆæ£’çš„æºä»£ç çº§åˆ«çš„å·¥å…·.</div><div class="line">dragonegg: gccæ’ä»¶ï¼Œå¯å°†GCCçš„ä¼˜åŒ–å’Œä»£ç ç”Ÿæˆå™¨æ›¿æ¢ä¸ºLLVMçš„ç›¸åº”å·¥å…·ã€‚</div><div class="line">LLDB:åŸºäºLLVMæä¾›çš„åº“å’ŒClangæ„å»ºçš„ä¼˜ç§€çš„æœ¬åœ°è°ƒè¯•å™¨ã€‚</div><div class="line">libc++ã€libc++ ABI: ç¬¦åˆæ ‡å‡†çš„ï¼Œé«˜æ€§èƒ½çš„C++æ ‡å‡†åº“å®ç°ï¼Œä»¥åŠå¯¹C++11çš„å®Œæ•´æ”¯æŒã€‚</div><div class="line">compiler-rt:é’ˆå¯¹__fixunsdfdiå’Œå…¶ä»–ç›®æ ‡æœºå™¨ä¸Šæ²¡æœ‰ä¸€ä¸ªæ ¸å¿ƒIR(intermediate representation)å¯¹åº”çš„çŸ­åŸç”ŸæŒ‡ä»¤åºåˆ—æ—¶ï¼Œæä¾›é«˜åº¦è°ƒä¼˜è¿‡çš„åº•å±‚ä»£ç ç”Ÿæˆæ”¯æŒã€‚</div><div class="line">OpenMP: Clangä¸­å¯¹å¤šå¹³å°å¹¶è¡Œç¼–ç¨‹çš„runtimeæ”¯æŒã€‚</div><div class="line">vmkit:åŸºäºLLVMçš„Javaå’Œ.NETè™šæ‹Ÿæœºå®</div><div class="line">polly: æ”¯æŒé«˜çº§åˆ«çš„å¾ªç¯å’Œæ•°æ®æœ¬åœ°åŒ–ä¼˜åŒ–æ”¯æŒçš„LLVMæ¡†æ¶ã€‚</div><div class="line">libclc: OpenCLæ ‡å‡†åº“çš„å®ç°</div><div class="line">klee: åŸºäºLLVMç¼–è¯‘åŸºç¡€è®¾æ–½çš„ç¬¦å·åŒ–è™šæ‹Ÿæœº</div><div class="line">SAFECode:å†…å­˜å®‰å…¨çš„C/C++ç¼–è¯‘å™¨</div><div class="line">lld: clang/llvmå†…ç½®çš„é“¾æ¥å™¨</div></pre></td></tr></table></figure></p>
<p><img src="/images/20170603/llvm_overView.png" alt=""><br><a href="http://llvm.org" target="_blank" rel="external">åŸæ–‡é“¾æ¥</a></p>
<p>1ã€clangæºç å¹¶ç¼–è¯‘å®‰è£…<br>æŸ¥çœ‹<a href="https://luohs.github.io/2017/05/30/20170530/" target="_blank" rel="external">clangæºç å¹¶ç¼–è¯‘å®‰è£…</a><br>2ã€ç¼–å†™clangæ’ä»¶<br>è¦å®ç°è‡ªå®šä¹‰çš„Clangæ’ä»¶(ä»¥C++ä¸ºä¾‹)ï¼Œåº”æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">1.è‡ªå®šä¹‰ç»§æ‰¿è‡ª</div><div class="line">	clang::PluginASTAction(åŸºäºconsumerçš„ASTå‰ç«¯ActionæŠ½è±¡åŸºç±»)</div><div class="line">	clang::ASTConsumer(ç”¨äºå®¢æˆ·è¯»å–ASTçš„æŠ½è±¡åŸºç±»)ï¼Œ</div><div class="line">	clang::RecursiveASTVisitor(å‰åºæˆ–åç»­åœ°æ·±åº¦ä¼˜å…ˆæœç´¢æ•´ä¸ª    	   ASTï¼Œå¹¶è®¿é—®æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„åŸºç±»)ç­‰åŸºç±»ï¼Œ</div><div class="line">2.æ ¹æ®è‡ªèº«éœ€è¦é‡è½½</div><div class="line">	PluginASTAction::CreateASTConsumerï¼Œ</div><div class="line">	PluginASTAction::ParseArgs,</div><div class="line">  ASTConsumer::HandleTranslationUnit</div><div class="line">  RecursiveASTVisitor::VisitDecl</div><div class="line">	RecursiveASTVisitor::VisitStmt</div><div class="line">  ç­‰æ–¹æ³•ï¼Œå®ç°è‡ªå®šä¹‰çš„åˆ†æé€»è¾‘ã€‚</div><div class="line">3.æ³¨å†Œæ’ä»¶</div><div class="line">	static FrontendPluginRegistry::Add&lt;MyPlugin&gt; X(&quot;my-plugin-name&quot;, &quot;my-plugin-description&quot;);</div><div class="line">4.ç¼–è¯‘æ—¶è½½å…¥æ’ä»¶</div><div class="line">	clang++ *** -Xclang -load -Xclang path-of-your-plugin.dylib -Xclang -add-plugin -Xclang your-pluginName -Xclang -plugin-arg-your-pluginName -Xclang your-pluginName-param</div></pre></td></tr></table></figure></p>
<p>ç¼–å†™clangæ’ä»¶ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">#include &lt;iostream&gt;</div><div class="line">#include &quot;clang/Frontend/FrontendPluginRegistry.h&quot;</div><div class="line">#include &quot;clang/AST/AST.h&quot;</div><div class="line">#include &quot;clang/AST/ASTConsumer.h&quot;</div><div class="line">#include &quot;clang/Frontend/CompilerInstance.h&quot;</div><div class="line">#include &quot;clang/AST/RecursiveASTVisitor.h&quot;</div><div class="line">using namespace clang;</div><div class="line">using namespace std;</div><div class="line">using namespace llvm;</div><div class="line">namespace ClangPlugin</div><div class="line">&#123;</div><div class="line">    class ClangPluginASTVisitor : public RecursiveASTVisitor&lt;ClangPluginASTVisitor&gt;</div><div class="line">    &#123;</div><div class="line">    private:</div><div class="line">        ASTContext *context;</div><div class="line">    public:</div><div class="line">        void setContext(ASTContext &amp;context)&#123;</div><div class="line">            this-&gt;context = &amp;context;</div><div class="line">        &#125;</div><div class="line">        bool VisitDecl(Decl *decl)&#123;</div><div class="line">            if(isa&lt;ObjCImplDecl&gt;(decl))&#123;</div><div class="line">                ObjCImplDecl *interDecl = (ObjCImplDecl*)decl;</div><div class="line">                cout&lt;&lt;&quot;[KWLM]Class Implementation Found:&quot;&lt;&lt;interDecl-&gt;getNameAsString()&lt;&lt;endl;</div><div class="line">            &#125;</div><div class="line">            return true;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    class ClangPluginASTConsumer : public ASTConsumer</div><div class="line">    &#123;</div><div class="line">    private:</div><div class="line">        ClangPluginASTVisitor visitor;</div><div class="line">        void HandleTranslationUnit(ASTContext &amp;context)&#123;</div><div class="line">            visitor.setContext(context);</div><div class="line">            visitor.TraverseDecl(context.getTranslationUnitDecl());</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    class ClangPluginASTAction : public PluginASTAction</div><div class="line">    &#123;</div><div class="line">    public:</div><div class="line">        unique_ptr&lt;ASTConsumer&gt; CreateASTConsumer(CompilerInstance &amp;Compiler,StringRef InFile)&#123;</div><div class="line">            return unique_ptr&lt;ClangPluginASTConsumer&gt;(new ClangPluginASTConsumer);</div><div class="line">        &#125;</div><div class="line">        bool ParseArgs(const CompilerInstance &amp;CI, const std::vector&lt;std::string&gt;&amp; args)&#123;</div><div class="line">            return true;</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">&#125;</div><div class="line">static clang::FrontendPluginRegistry::Add&lt;ClangPlugin::ClangPluginASTAction&gt;X(&quot;ClangPlugin&quot;, &quot;ClangPlugin&quot;);</div></pre></td></tr></table></figure></p>
<p>ç¼–è¯‘ç”Ÿæˆæ’ä»¶(dylib)ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">clang -std=c++11 -stdlib=libc++ -L/opt/local/lib -L/opt/llvm/llvm_build/lib -I/opt/llvm/llvm_build/tools/clang/include -I/opt/llvm/llvm_build/include -I/opt/llvm/llvm/tools/clang/include -I/opt/llvm/llvm/include -dynamiclib -Wl,-headerpad_max_install_names -lclang -lclangFrontend -lclangAST -lclangAnalysis -lclangBasic -lclangCodeGen -lclangDriver -lclangFrontendTool -lclangLex -lclangParse -lclangSema -lclangEdit -lclangSerialization -lclangStaticAnalyzerCheckers -lclangStaticAnalyzerCore -lclangStaticAnalyzerFrontend -lLLVMX86CodeGen -lLLVMX86AsmParser -lLLVMX86Disassembler -lLLVMExecutionEngine -lLLVMAsmPrinter -lLLVMSelectionDAG -lLLVMX86AsmPrinter -lLLVMX86Info -lLLVMMCParser -lLLVMCodeGen -lLLVMX86Utils -lLLVMScalarOpts -lLLVMInstCombine -lLLVMTransformUtils -lLLVMAnalysis -lLLVMTarget -lLLVMCore -lLLVMMC -lLLVMSupport -lLLVMBitReader -lLLVMOption -lLLVMProfileData -lpthread -lcurses -lz -lstdc++ -fPIC -fno-common -Woverloaded-virtual -Wcast-qual -fno-strict-aliasing -pedantic -Wno-long-long -Wall -Wno-unused-parameter -Wwrite-strings -fno-rtti -fPIC your-clang-plugin-source.cpp -o your-clang-plugin-name.dylib</div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨clangç¼–è¯‘ocæ–‡ä»¶(è½½å…¥ç”Ÿæˆçš„your-clang-plugin-name.dylib):<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/opt/llvm/llvm_build/bin/clang -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator10.0.sdk -I/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/include/c++/v1 -mios-version-min=8.0 -Xclang -load -Xclang ~/Desktop/your-clang-plugin-name.dylib -Xclang -add-plugin -Xclang your-clang-plugin-name -c ./ocClsDemo.m</div></pre></td></tr></table></figure></p>
<p>Xcodeé›†æˆClangæ’ä»¶:<br>è¦åœ¨Xcodeä¸­ä½¿ç”¨Clangæ’ä»¶ï¼Œéœ€è¦Hack Xcode.appã€‚<br><a href="https://raw.githubusercontent.com/kangwang1988/kangwang1988.github.io/master/others/XcodeHacking.zip" target="_blank" rel="external">XcodeHacking.zip</a><br>é€šè¿‡command-lineæ–¹å¼æˆ–è€…æ‰‹åŠ¨æ‹·è´çš„æ–¹å¼å°†XcodeHackæ‹·è´åˆ°Xcodeç›®å½•ä¸­ï¼Œå¦‚æœSpecificationsæ–‡ä»¶ä¸å­˜åœ¨åˆ™æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo mv HackedClang.xcplugin `xcode-select -print- path`/../PlugIns/Xcode3Core.ideplugin/Contents/SharedSupport/Developer/Library/Xcode/Plug-ins</div><div class="line">sudo mv HackedBuildSystem.xcspec `xcode-select -print- path`/../Developer/Platforms/iPhoneSimulator.platform/Developer/Library/Xcode/Specifications</div></pre></td></tr></table></figure></p>
<p><img src="/images/20170603/XcodeHack_plugin.png" alt=""><br><img src="/images/20170603/XcodeHack_spec.png" alt=""><br>ä¹‹ååœ¨Xcode-&gt;Target-Build Settings-&gt;Build Options-&gt;Compiler for C/C++/Objective-Cé€‰æ‹©Clang LLVM Trunkå³å¯ä½¿å¾—Xcodeä½¿ç”¨1ç”Ÿæˆçš„çš„Clangæ¥ç¼–è¯‘ã€‚è‡³äºå…¶ä»–çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œå‡å¯ä»¥é€šè¿‡Xcodeè®¾ç½®å®Œæˆã€‚<br><img src="/images/20170603/XcodeHack_buildsetting.png" alt=""><br>3ã€clangæ’ä»¶åœ¨Xcodeå·¥ç¨‹çš„é…ç½®ï¼š<br><a href="https://github.com/kangwang1988/XcodeZombieCode.git" target="_blank" rel="external">clangæ’ä»¶ç¤ºä¾‹å·¥ç¨‹</a><br>aã€é¦–å…ˆé€šè¿‡Xcodeå°†è‡ªå®šä¹‰clangæ’ä»¶ç¼–è¯‘æˆåŠ¨æ€åº“ï¼ˆdylibï¼‰ã€‚<br><img src="/images/20170603/clang_plugin_out.png" alt=""><br><img src="/images/20170603/clang_plugin_out_2.png" alt=""><br>bã€å…¶æ¬¡ç¼–è¯‘ç”Ÿæˆåˆ†æå·¥å…·XcodeCodeAnalyser<br><img src="/images/20170603/clang_analyzer_out.png" alt=""><br><img src="/images/20170603/clang_analyzer_out_2.png" alt=""><br>cã€è®¾ç½®å·¥ç¨‹<br>ä½¿ç”¨ç”¨æˆ·ç¼–è¯‘çš„Clangè½½å…¥ClangPluginå»ç¼–è¯‘å¹¶ç”Ÿæˆå„ç§ä¸­é—´æ–‡ä»¶ã€‚ç¼–è¯‘å®Œæˆä¹‹åä½¿ç”¨Xcodeæä¾›çš„post_build_action_shellæœºåˆ¶è°ƒç”¨åˆ†æå·¥å…·ï¼Œç”Ÿæˆæœ€ç»ˆç»“æœã€‚<br><img src="/images/20170603/post_build_action_shell_1.png" alt=""><br><img src="/images/20170603/post_build_action_shell_2.png" alt=""><br><img src="/images/20170603/post_build_action_shell_script.png" alt=""></p>
<p>å‚è€ƒï¼š<br><a href="http://railsware.com/blog/2014/02/28/creation-and-using-clang-plugin-with-xcode/" target="_blank" rel="external">http://railsware.com/blog/2014/02/28/creation-and-using-clang-plugin-with-xcode/</a><br><a href="http://blog.mrriddler.com/2017/02/24/Clangæ’ä»¶-Sherlock/" target="_blank" rel="external">http://blog.mrriddler.com/2017/02/24/Clangæ’ä»¶-Sherlock/</a><br><a href="https://lmsgsendnilself.github.io/blog/2017/02/28/clangtojszi-yuan/" target="_blank" rel="external">https://lmsgsendnilself.github.io/blog/2017/02/28/clangtojszi-yuan/</a><br><a href="http://kangwang1988.github.io/tech/2016/11/01/validate-ios-api-using-clang-plugin.html" target="_blank" rel="external">http://kangwang1988.github.io/tech/2016/11/01/validate-ios-api-using-clang-plugin.html</a><br><a href="https://github.com/kangwang1988/XcodeValidAPI" target="_blank" rel="external">https://github.com/kangwang1988/XcodeValidAPI</a><br><a href="http://www.cocoachina.com/ios/20151211/14562.html" target="_blank" rel="external">http://www.cocoachina.com/ios/20151211/14562.html</a><br><a href="http://mp.weixin.qq.com/s?__biz=MzA3ODg4MDk0Ng==&amp;mid=2651112096&amp;idx=1&amp;sn=ce8fccce7d5f70e30c078e63e8ea0d15&amp;scene=21#wechat_redirect" target="_blank" rel="external">http://mp.weixin.qq.com/s?__biz=MzA3ODg4MDk0Ng==&amp;mid=2651112096&amp;idx=1&amp;sn=ce8fccce7d5f70e30c078e63e8ea0d15&amp;scene=21#wechat_redirect</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/01/20170602/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="èŠ±ç”Ÿ-sniper">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸‰å‘³çŒªå±‹">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸‰å‘³çŒªå±‹" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/01/20170602/" itemprop="url">
                  ä»£ç ç»Ÿè®¡å°è´´ç¤º
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-01T14:38:29+08:00">
                2017-06-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/cloc/" itemprop="url" rel="index">
                    <span itemprop="name">cloc</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><p><a href="https://osdn.net/frs/g_redir.php?m=netix&amp;f=%2Fcloc%2Fcloc%2Fv1.64%2Fcloc-1.64.pl" target="_blank" rel="external">cloc-1.64.pl</a><br><a href="https://github.com/AlDanial/cloc" target="_blank" rel="external">CLOCæºç åœ°å€</a><br>ç”¨æ³•ä¸€ï¼šç›´æ¥æ‰§è¡Œperlè„šæœ¬ï¼Œå¦‚å›¾ï¼š<br><img src="/images/20170601A/cloc_script.png" alt=""><br>ç”¨æ³•äºŒï¼šé€šè¿‡brewå®‰è£…clocï¼Œä½¿ç”¨å‘½ä»¤è¡Œæ–¹å¼ï¼Œå¦‚å›¾ï¼š<br><img src="/images/20170601A/cloc_commandline.png" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/01/20170601/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="èŠ±ç”Ÿ-sniper">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸‰å‘³çŒªå±‹">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸‰å‘³çŒªå±‹" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/01/20170601/" itemprop="url">
                  iOSåŒ…å¤§å°ç˜¦èº«æ–¹æ¡ˆï¼ˆä¸€ï¼‰- iOSå®‰è£…åŒ…æ„æˆ
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-01T09:12:50+08:00">
                2017-06-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/app-thinning/" itemprop="url" rel="index">
                    <span itemprop="name">app-thinning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><p>è¦æƒ³å°†iOSå®‰è£…åŒ…ç˜¦èº«ï¼Œé¦–å…ˆå¾—ç†Ÿæ‚‰iOSå®‰è£…åŒ…çš„æ„æˆï¼Œç„¶åæ ¹æ®å„ä¸ªéƒ¨åˆ†é€ä¸ªä¼˜åŒ–ã€‚<br>1ã€iOSå®‰è£…åŒ…æ„æˆï¼š<br>iOSå®‰è£…åŒ…æ˜¯ä»¥åç¼€åä¸ºâ€œipaâ€ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè¯¥å‹ç¼©åŒ…å†…å®¹å¤§è‡´åŒ…å«ä¸‰å—å†…å®¹ï¼šå¯æ‰§è¡Œæ–‡ä»¶ã€èµ„æºæ–‡ä»¶ã€ç­¾åæ–‡ä»¶<br>æ„æˆå¦‚ä¸‹å›¾ï¼š<br><img src="/images/20170601/ipa_archive.png" alt=""><br>2ã€å¯æ‰§è¡Œæ–‡ä»¶æ„æˆï¼š<br>å¯æ‰§è¡Œæ–‡ä»¶æ˜¯é€šè¿‡ç¼–è¯‘å™¨ã€è¿æ¥å™¨å°†æˆ‘ä»¬ç¼–å†™çš„ä»£ç ã€é™æ€åº“ã€åŠ¨æ€åº“ç¼–è¯‘æˆçš„æ–‡ä»¶ï¼Œå¤§è‡´å¯åˆ†ä¸ºä»£ç æ®µå’Œæ•°æ®æ®µ<br>æ„æˆå¦‚ä¸‹ï¼š<br><img src="/images/20170601/ipa_mach.png" alt=""><br>3ã€å¯æ‰§è¡Œæ–‡ä»¶æ”¯æŒçš„cpuæ¶æ„ä»¥åŠå®‰è£…åŒ…å¤§å°å…³ç³»<br>ä»¥â€œæ»´æ»´æ‰“è½¦â€ä¸ºä¾‹ï¼Œå¯¹æ¯”å»å¹´3.9.7ç‰ˆæœ¬ä»¥åŠæœ€æ–°4.3.10ç‰ˆæœ¬<br>3.9.7ç‰ˆæœ¬ï¼š<br><img src="/images/20170601/didi_3_9_7.png" alt=""><br><img src="/images/20170601/didi_3_9_7_2.png" alt=""><br><img src="/images/20170601/didi_3_9_7_3.png" alt=""><br>4.3.10ç‰ˆæœ¬ï¼š<br><img src="/images/20170601/didi_4_3_10_1.png" alt=""><br><img src="/images/20170601/didi_4_3_10_2.png" alt=""><br><img src="/images/20170601/didi_4_3_10_3.png" alt=""><br>ç”±æ­¤å¯è§æ”¯æŒçš„CPUä½“ç³»æ¶æ„è¶Šå¤šï¼Œå¯¹å®‰è£…åŒ…å¤§å°æˆæ­£æ¯”ä¾‹å½±å“ã€‚<br>4ã€å¯æ‰§è¡Œæ–‡ä»¶å„æ®µæ‰€å å¤§å°<br>64ä½æ¶æ„ï¼š<br><img src="/images/20170601/ipa_archive_linkmap_arm64_1.png" alt=""><br><img src="/images/20170601/ipa_archive_linkmap_arm64_2.png" alt=""><br><img src="/images/20170601/ipa_archive_linkmap_arm64_3.png" alt=""><br>32ä½æ¶æ„ï¼š<br><img src="/images/20170601/ipa_archive_linkmap_arm7_1.png" alt=""><br><img src="/images/20170601/ipa_archive_linkmap_arm7_2.png" alt=""><br><img src="/images/20170601/ipa_archive_linkmap_arm7_3.png" alt=""><br>5ã€ç¬¬ä¸‰æ–¹SDKå¤§å°å æ¯”<br><img src="/images/20170601/ipa_archive_sdk_linkmap_arm64.png" alt=""><br><img src="/images/20170601/ipa_archive_sdk_linkmap_arm7.png" alt=""><br><img src="/images/20170601/ipa_archive_sdk_size_1.png" alt=""><br><img src="/images/20170601/ipa_archive_sdk_size_2.png" alt=""><br><img src="/images/20170601/ipa_archive_size_1.png" alt=""><br><img src="/images/20170601/ipa_archive_size_2.png" alt=""><br>é€šè¿‡æ¯”è¾ƒä¸éš¾çœ‹å‡ºç¬¬ä¸‰æ–¹SDKç¼–è¯‘å‡ºæ¥çš„å¯æ‰§è¡Œæ–‡ä»¶å æ¯”è¾¾åˆ°62.5%<br>6ã€èµ„æºæ–‡ä»¶å¯¹å®‰è£…åŒ…çš„å½±å“<br>æœªå¯¹å›¾ç‰‡èµ„æºè¿›è¡Œæ— æŸå‹ç¼©ä¹‹ååŒ…å¤§å°<br><img src="/images/20170601/ipa_archive_size_4.png" alt=""><br>å¯¹å›¾ç‰‡èµ„æºè¿›è¡Œæ— æŸå‹ç¼©ä¹‹ååŒ…å¤§å°<br><img src="/images/20170601/ipa_archive_size_3.png" alt=""><br>ä¸‹å›¾ä¸ºå¯¹æˆ‘ä»¬appä¸­å›¾ç‰‡èµ„æºè¿›è¡Œæ— æŸå‹ç¼©çš„æ•ˆæœï¼š<br><img src="/images/20170601/imageOptim.png" alt=""></p>
<p>Tipsï¼š<br>1ã€æŸ¥çœ‹å¯æ‰§è¡Œæ–‡ä»¶å¤§å°ï¼š<br><img src="/images/20170601/linkmap_setting_1.png" alt=""><br><img src="/images/20170601/linkmap_setting_2.png" alt=""><br><img src="/images/20170601/linkmap_used.png" alt=""><br><a href="https://github.com/luohs/luohs.github.io/blob/master/images/20170601/linkmap.js" target="_blank" rel="external">linkmap.js</a><br>2ã€MachOViewä½¿ç”¨ï¼š<br><a href="http://sourceforge.net/projects/machoview/" target="_blank" rel="external">MachOViewä¸‹è½½åœ°å€</a><br><a href="https://github.com/gdbinit/MachOView" target="_blank" rel="external">MachOViewæºç åœ°å€</a><br>3ã€ImageOptimä½¿ç”¨ï¼š<br><a href="https://imageoptim.com/mac" target="_blank" rel="external">ImageOptimä¸‹è½½åœ°å€</a><br>4ã€å»é™¤å·¥ç¨‹ä¸­å¤šä½™çš„å›¾ç‰‡èµ„æºï¼š<br>aã€è„šæœ¬<br>è¯¦è§<a href="https://stackoverflow.com/questions/6113243/how-to-find-unused-images-in-an-xcode-project/6113449#6113449" target="_blank" rel="external">é“¾æ¥</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">#!/bin/sh</div><div class="line">PROJ=`find . -name &apos;*.xib&apos; -o -name &apos;*.[mh]&apos;`</div><div class="line">for png in `find . -name &apos;*.png&apos;`</div><div class="line">do</div><div class="line">name=`basename $png`</div><div class="line">if ! grep -qhs &quot;$name&quot; &quot;$PROJ&quot;; then</div><div class="line">    echo &quot;$png is not referenced&quot;</div><div class="line">fi</div><div class="line">done</div></pre></td></tr></table></figure></p>
<p>bã€Unused<br><a href="http://jeffhodnett.github.io/Unused/" target="_blank" rel="external">Unused</a><br>cã€LSUnusedResources<br><a href="https://github.com/tinymind/LSUnusedResources/" target="_blank" rel="external">LSUnusedResources</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/31/20170531/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="èŠ±ç”Ÿ-sniper">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸‰å‘³çŒªå±‹">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸‰å‘³çŒªå±‹" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/31/20170531/" itemprop="url">
                  æ·±å…¥ç†è§£"weak-strong dance"
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-05-31T15:09:22+08:00">
                2017-05-31
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/weak-strong-dance/" itemprop="url" rel="index">
                    <span itemprop="name">weak-strong dance</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><p>ä½¿ç”¨blockæ—¶åˆ©ç”¨â€weak-strong danceâ€è§£å†³å¾ªç¯å¼•ç”¨å¤§å®¶éƒ½çŸ¥é“ï¼Œä½†è¿™é‡Œæœ‰ä¸‰ç‚¹å€¼å¾—æ³¨æ„ï¼š<br>1ã€å½“selfæŒ‡å‘çš„å¯¹è±¡å·²ç»è¢«åºŸå¼ƒçš„æƒ…å†µä¸‹ï¼ŒæŒæœ‰blockæˆå‘˜å˜é‡ä¹Ÿä¸å­˜åœ¨äº†ï¼Œè¿™ä¸ªæ—¶å€™blockå¯¹è±¡åº”è¯¥å·²ç»æ²¡æœ‰è¢«å˜é‡æ‰€æŒæœ‰äº†ï¼Œå®ƒçš„å¼•ç”¨è®¡æ•°åº”è¯¥å·²ç»ä¸º0äº†ï¼Œå®ƒåº”è¯¥è¢«åºŸå¼ƒäº†å•Šï¼Œä¸ºä»€ä¹ˆå®ƒè¿˜èƒ½ç»§ç»­å­˜åœ¨å¹¶æ‰§è¡Œã€‚<br>å¦‚ä»¥ä¸‹ä»£ç ï¼Œåœ¨ block æ‰§è¡Œå‰é€€å‡ºè¿™ä¸ªé¡µé¢çš„è¯ï¼Œè¯¥ Controller å®ä¾‹ä¼šè¢«åºŸå¼ƒï¼Œä½† Block è¿˜æ˜¯ä¼šæ‰§è¡Œï¼Œä¼šæ‰“å°â€œself is (null)â€ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">- (void)viewDidLoad &#123;</div><div class="line">    [super viewDidLoad];</div><div class="line"></div><div class="line">    __weak typeof(self) weakSelf = self;</div><div class="line">    self.handler = ^&#123;</div><div class="line">        __strong typeof(weakSelf) strongSelf = weakSelf;</div><div class="line">        NSLog(@&quot;self is %@&quot;, strongSelf);</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    NSTimeInterval interval = 6.0;</div><div class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(interval * NSEC_PER_SEC)), dispatch_get_main_queue(), weakSelf.handler);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç†è§£è¿™ä¸ªé—®é¢˜éœ€è¦äº†è§£blockåŸç†ï¼Œç®€å•ä¸€ç‚¹çš„è¯´ï¼Œblockæœ‰ä¸‰ç§ç±»å‹ï¼š<br>NSConcreteStackBlockï¼ˆæ ˆï¼‰<br>NSConcreteGlobalBlockï¼ˆå…¨å±€ï¼‰<br>NSConcreteMallocBlockï¼ˆå †ï¼‰</p>
<p>å¦‚ä½•å®ç°è¿™ä¸‰ç§ç±»å‹çš„blockï¼š<br><img src="/images/20170531/block_objc.png" alt=""><br>ä½¿ç”¨<code>clang -rewrite-objc $filePath</code>å°†OCä»£ç è½¬åŒ–ä¸ºC++ä»£ç å®ç°ã€‚<a href="https://luohs.github.io/2017/05/30/20170530/" target="_blank" rel="external">å¦‚ä½•å®‰è£…ç¼–è¯‘clang</a><br><img src="/images/20170531/clang_rewrite.png" alt=""><br><img src="/images/20170531/block_clang.png" alt=""><br>å¦‚æœ block åœ¨è®°è¿°å…¨å±€å˜é‡çš„åœ°æ–¹è¢«è®¾ç½®æˆ–è€… block æ²¡æœ‰æ•è·å¤–éƒ¨å˜é‡ï¼Œé‚£å°±ç”Ÿæˆä¸€ä¸ª NSConcreteGlobalBlock å®ä¾‹ã€‚å…¶å®ƒæƒ…å†µéƒ½ä¼šç”Ÿæˆä¸€ä¸ª NSConcreteStackBlock å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ˜¯åœ¨æ ˆä¸Šçš„ï¼Œæ‰€ä»¥ä¸€æ—¦å®ƒæ‰€å±çš„å˜é‡è¶…å‡ºäº†å˜é‡ä½œç”¨åŸŸï¼Œè¯¥ block å°±è¢«åºŸå¼ƒäº†ã€‚è€Œå½“å‘ç”Ÿä»¥ä¸‹ä»»ä¸€æƒ…å†µæ—¶ï¼š<br>aã€æ‰‹åŠ¨è°ƒç”¨ block çš„å®ä¾‹æ–¹æ³•copyã€‚<br>bã€block ä½œä¸ºå‡½æ•°è¿”å›å€¼è¿”å›ã€‚<br>cã€å°† block èµ‹å€¼ç»™é™„æœ‰__strongä¿®é¥°ç¬¦çš„æˆå‘˜å˜é‡ã€‚<br>dã€åœ¨æ–¹æ³•åä¸­å«æœ‰usingBlockçš„ Cocoa æ¡†æ¶æ–¹æ³•æˆ– GCD çš„ API ä¸­ä¼ é€’ blockã€‚<br>æ‰€ä»¥NSConcreteMallocBlock ç±»å‹çš„ block é€šå¸¸ä¸ä¼šåœ¨æºç ä¸­ç›´æ¥å‡ºç°ã€‚<br><a href="http://www.galloway.me.uk/2013/05/a-look-inside-blocks-episode-3-block-copy/" target="_blank" rel="external">çœ‹ä¸€ä¸‹Block_copy()å®ç°</a>ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">static void *_Block_copy_internal(const void *arg, const int flags) &#123;</div><div class="line">    struct Block_layout *aBlock;</div><div class="line">    const bool wantsOne = (WANTS_ONE &amp; flags) == WANTS_ONE;</div><div class="line"></div><div class="line">    // 1</div><div class="line">    if (!arg) return NULL;</div><div class="line"></div><div class="line">    // 2</div><div class="line">    aBlock = (struct Block_layout *)arg;</div><div class="line"></div><div class="line">    // 3</div><div class="line">    if (aBlock-&gt;flags &amp; BLOCK_NEEDS_FREE) &#123;</div><div class="line">        // latches on high</div><div class="line">        latching_incr_int(&amp;aBlock-&gt;flags);</div><div class="line">        return aBlock;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 4</div><div class="line">    else if (aBlock-&gt;flags &amp; BLOCK_IS_GLOBAL) &#123;</div><div class="line">        return aBlock;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // 5</div><div class="line">    struct Block_layout *result = malloc(aBlock-&gt;descriptor-&gt;size);</div><div class="line">    if (!result) return (void *)0;</div><div class="line"></div><div class="line">    // 6</div><div class="line">    memmove(result, aBlock, aBlock-&gt;descriptor-&gt;size); // bitcopy first</div><div class="line"></div><div class="line">    // 7</div><div class="line">    result-&gt;flags &amp;= ~(BLOCK_REFCOUNT_MASK);    // XXX not needed</div><div class="line">    result-&gt;flags |= BLOCK_NEEDS_FREE | 1;</div><div class="line"></div><div class="line">    // 8</div><div class="line">    result-&gt;isa = _NSConcreteMallocBlock;</div><div class="line"></div><div class="line">    // 9</div><div class="line">    if (result-&gt;flags &amp; BLOCK_HAS_COPY_DISPOSE) &#123;</div><div class="line">        (*aBlock-&gt;descriptor-&gt;copy)(result, aBlock); // do fixup</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    return result;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œå·²ç»å¯ä»¥è§£ç­”é—®é¢˜1ã€‚æŠŠ block èµ‹å€¼ç»™self.handlerçš„æ—¶å€™ï¼Œåœ¨æ ˆä¸Šç”Ÿæˆçš„ block è¢«å¤åˆ¶äº†ä¸€ä»½æ”¾åˆ°å †ä¸Šã€‚è€Œä¹‹åå¦‚æœä½ æŠŠè¿™ä¸ª block å½“ä½œ GCD å‚æ•°ä½¿ç”¨ï¼ŒGCD å‡½æ•°å†…éƒ¨ä¼šæŠŠè¯¥ block å† copy ä¸€éï¼Œè€Œæ­¤æ—¶ block å·²ç»åœ¨å †ä¸Šï¼Œåˆ™è¯¥ block çš„å¼•ç”¨è®¡æ•°åŠ 1ã€‚æ‰€ä»¥æ­¤æ—¶ block çš„å¼•ç”¨è®¡æ•°æ˜¯å¤§äº1çš„ï¼Œå³ä½¿selfå¯¹è±¡è¢«åºŸå¼ƒ block ä¼šè¢« release ä¸€æ¬¡ï¼Œä½†å®ƒçš„å¼•ç”¨è®¡æ•°ä»ç„¶å¤§äº0ï¼Œæ•…è€Œä¸ä¼šè¢«åºŸå¼ƒã€‚<br>Tips:<br>å…¶å®åœ¨ ARC å¼€å¯çš„æƒ…å†µä¸‹ï¼Œå°†åªä¼šæœ‰ NSConcreteGlobalBlock å’Œ NSConcreteMallocBlock ç±»å‹çš„ blockã€‚<br><img src="/images/20170531/block_work_in_ARC.png" alt=""><br>æ›´å¤šè¯·æŸ¥çœ‹<a href="https://developer.apple.com/library/content/releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html" target="_blank" rel="external">è‹¹æœå®˜æ–¹æ–‡æ¡£</a></p>
<p>2ã€åœ¨ block å†…éƒ¨ä½¿ç”¨weakSelfå°±æ˜¯ä¸ºäº†è®© block å¯¹è±¡ä¸æŒæœ‰selfæŒ‡å‘çš„å¯¹è±¡ï¼Œé‚£åœ¨ block å†…éƒ¨åˆæŠŠweakSelfèµ‹ç»™strongSelfä¸å°±åˆæŒæœ‰selfå¯¹è±¡äº†ä¹ˆï¼Ÿåˆå¾ªç¯å¼•ç”¨äº†ï¼Ÿ<br>ç†è§£è¿™ä¸ªé—®é¢˜å°±éœ€è¦äº†è§£blockæ•è·å¯¹è±¡å˜é‡ã€‚<br>ä½¿ç”¨<strong>weakä¿®é¥°çš„å˜é‡æ—¶</strong>weakæ˜¯ä¸ä¼šæŒæœ‰å¯¹è±¡ï¼Œå®ƒç”¨ä¸€å¼  weak è¡¨æ¥ç®¡ç†å¯¹è±¡å’Œå˜é‡ã€‚èµ‹å€¼çš„æ—¶å€™å®ƒä¼šä»¥èµ‹å€¼å¯¹è±¡çš„åœ°å€ä½œä¸º keyï¼Œå˜é‡çš„åœ°å€ä¸º valueï¼Œæ³¨å†Œåˆ° weak è¡¨ä¸­ã€‚ä¸€æ—¦è¯¥å¯¹è±¡è¢«åºŸå¼ƒï¼Œå°±é€šè¿‡å¯¹è±¡åœ°å€åœ¨ weak è¡¨ä¸­æ‰¾åˆ°å˜é‡çš„åœ°å€ï¼Œèµ‹å€¼ä¸º nilï¼Œç„¶åå°†è¯¥æ¡è®°å½•ä» weak è¡¨ä¸­åˆ é™¤ã€‚<br>é‚£ä½¿ç”¨ â€œweak-strong danceâ€ çš„æ—¶å€™æ˜¯æ€ä¹ˆä¸ªæƒ…å†µå‘¢ï¼Ÿ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">struct __block_impl &#123;</div><div class="line">    void *isa;</div><div class="line">    int Flags;</div><div class="line">    int Reserved;</div><div class="line">    void *FuncPtr;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">struct __xx_block_impl_y &#123;</div><div class="line">    struct __block_impl impl;</div><div class="line">    __weak OCClass *occlass;</div><div class="line">    // ...</div><div class="line">&#125;;</div><div class="line"></div><div class="line">static void __xx_block_func_y(struct __xx_block_impl_y *__cself) &#123;</div><div class="line">    OCClass *occlass = __cself -&gt; occlass;</div><div class="line">    // ...</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æ¯æ¬¡ä½¿ç”¨<strong>weakå˜é‡çš„æ—¶å€™ï¼Œéƒ½ä¼šå–å‡ºè¯¥å˜é‡æŒ‡å‘çš„å¯¹è±¡å¹¶ retainï¼Œç„¶åå°†è¯¥å¯¹è±¡æ³¨å†Œåˆ° autoreleasepool ä¸­ã€‚é€šè¿‡ä¸Šè¿°ä»£ç æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œåœ¨</strong>xx_block_func_yä¸­ï¼Œå±€éƒ¨å˜é‡occlassä¼šæŒæœ‰æ•è·çš„å¯¹è±¡ï¼Œç„¶åå¯¹è±¡ä¼šè¢«æ³¨å†Œåˆ° autoreleasepoolã€‚è¿™æ˜¯å»¶é•¿å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„å…³é”®ï¼ˆä¿è¯åœ¨æ‰§è¡Œ Block æœŸé—´å¯¹è±¡ä¸ä¼šè¢«åºŸå¼ƒï¼‰ï¼Œä½†è¿™ä¸ä¼šé€ æˆå¾ªç¯å¼•ç”¨ï¼Œå½“å‡½æ•°æ‰§è¡Œç»“æŸï¼Œå˜é‡occlassè¶…å‡ºä½œç”¨åŸŸï¼Œè¿‡ä¸€ä¼šå„¿ï¼ˆä¸€èˆ¬ä¸€æ¬¡ RunLoop ä¹‹åï¼‰ï¼Œå¯¹è±¡å°±è¢«é‡Šæ”¾äº†ã€‚æ‰€ä»¥ weak-strong dance çš„è¡Œä¸ºéå¸¸ç¬¦åˆé¢„æœŸï¼šå»¶é•¿æ•è·å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¸€æ—¦ Block æ‰§è¡Œå®Œï¼Œå¯¹è±¡è¢«é‡Šæ”¾ï¼Œè€Œ Block ä¹Ÿä¼šè¢«é‡Šæ”¾ï¼ˆå¦‚æœè¢« GCD ä¹‹ç±»çš„ API copy è¿‡ä¸€æ¬¡å¢åŠ äº†å¼•ç”¨è®¡æ•°ï¼Œé‚£æœ€ç»ˆä¹Ÿä¼šè¢« GCD é‡Šæ”¾ï¼‰ã€‚</p>
<p>3ã€ä½¿ç”¨â€weak-strong danceâ€ä¸€å®šå®‰å…¨å—ï¼Ÿ<br>å…¶å®é€šè¿‡é—®é¢˜2å°±å¯ä»¥ç†è§£ï¼Œâ€weak-strong danceâ€å¹¶ä¸æ˜¯å®‰å…¨çš„ï¼Œâ€weak-strong danceâ€åªå®ç”¨ä¸blockå·²ç»æ•è·åˆ°å¯¹è±¡çš„æƒ…å†µï¼Œâ€weak-strong danceâ€å¹¶ä¸èƒ½ä¿è¯ block æ‰€å¼•ç”¨å¯¹è±¡çš„é‡Šæ”¾æ—¶æœºåœ¨æ‰§è¡Œä¹‹åï¼Œ æ›´å®‰å…¨çš„åšæ³•åº”è¯¥æ˜¯åœ¨ block å†…éƒ¨ä½¿ç”¨ strongSelf æ—¶è¿›è¡Œ nilæ£€æµ‹ï¼Œè¿™æ ·å¯ä»¥é¿å…ä¸Šè¿°æƒ…å†µã€‚</p>
<p>å‚è€ƒï¼š<br><a href="https://developer.apple.com/library/content/releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html" target="_blank" rel="external">https://developer.apple.com/library/content/releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html</a><br><a href="http://www.galloway.me.uk/2013/05/a-look-inside-blocks-episode-3-block-copy/" target="_blank" rel="external">http://www.galloway.me.uk/2013/05/a-look-inside-blocks-episode-3-block-copy/</a><br><a href="http://blog.devtang.com/2013/07/28/a-look-inside-blocks/" target="_blank" rel="external">http://blog.devtang.com/2013/07/28/a-look-inside-blocks/</a><br><a href="http://albertodebortoli.com/blog/2013/08/03/objective-c-blocks-caveat/" target="_blank" rel="external">http://albertodebortoli.com/blog/2013/08/03/objective-c-blocks-caveat/</a><br><a href="http://www.jianshu.com/p/737999a30544" target="_blank" rel="external">http://www.jianshu.com/p/737999a30544</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/30/20170530/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="èŠ±ç”Ÿ-sniper">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸‰å‘³çŒªå±‹">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸‰å‘³çŒªå±‹" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/30/20170530/" itemprop="url">
                  clangæºç ç¼–è¯‘å®‰è£…
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-05-30T21:40:11+08:00">
                2017-05-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/clang/" itemprop="url" rel="index">
                    <span itemprop="name">clang</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><p>ç¯å¢ƒé…ç½®ï¼š<br>1ã€<a href="https://luohs.github.io/2017/05/27/20170527/" target="_blank" rel="external">é…ç½®Git</a><br>2ã€å®‰è£…cmakeç¼–è¯‘ç¯å¢ƒ<br><img src="/images/20170530/cmake_install.png" alt=""><br><img src="/images/20170530/cmake_install_success.png" alt=""></p>
<p>ä¸‹è½½ä»£ç ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">cd /opt</div><div class="line">sudo mkdir llvm</div><div class="line">sudo chown `whoami` llvm</div><div class="line">cd llvm</div><div class="line">export LLVM_HOME=`pwd`</div><div class="line"></div><div class="line">git clone -b release_39 git@github.com:llvm-mirror/llvm.git llvm</div><div class="line">git clone -b release_39 git@github.com:llvm-mirror/clang.git llvm/tools/clang</div><div class="line">git clone -b release_39 git@github.com:llvm-mirror/clang-tools-extra.git llvm/tools/clang/tools/extra</div><div class="line">git clone -b release_39 git@github.com:llvm-mirror/compiler-rt.git llvm/projects/compiler-rt</div></pre></td></tr></table></figure></p>
<p><img src="/images/20170530/clang_git_clone.png" alt=""></p>
<p>ç¼–è¯‘ä»£ç ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">mkdir llvm_build</div><div class="line">cd llvm_build</div><div class="line">cmake ../llvm -DCMAKE_BUILD_TYPE:STRING=Release</div><div class="line">make -j`sysctl -n hw.logicalcpu`</div></pre></td></tr></table></figure></p>
<p><img src="/images/20170530/clang_cmake.png" alt=""><br><img src="/images/20170530/clang_cmake_success.png" alt=""><br><img src="/images/20170530/clang_make.png" alt=""><br><img src="/images/20170530/clang_make_success.png" alt=""></p>
<p>ç»“æœï¼š<br><img src="/images/20170530/clang_build_dir.png" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/27/20170527/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="èŠ±ç”Ÿ-sniper">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸‰å‘³çŒªå±‹">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸‰å‘³çŒªå±‹" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/27/20170527/" itemprop="url">
                  Macé…ç½®Git
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-05-27T10:30:51+08:00">
                2017-05-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><p>å®‰è£…Gitï¼š<br>ä¸å¤§å¤šæ•°è½¯ä»¶åœ¨Macä¸Šå®‰è£…ä¸€æ ·ï¼Œå®‰è£…æ–¹å¼åŸºæœ¬ä¸Šéƒ½æä¾›ä¸‰ç§æ–¹å¼ï¼š<br>1ã€é€šè¿‡pkgæˆ–è€…dmgå®‰è£…ã€‚<br><a href="http://sourceforge.net/projects/git-osx-installer/" target="_blank" rel="external">http://sourceforge.net/projects/git-osx-installer/</a><br>2ã€é€šè¿‡MacPortså®‰è£…ã€‚<br><code>$ sudo port install git-core +svn +doc +bash_completion +gitweb</code><br>3ã€é€šè¿‡homebrewå®‰è£…ã€‚<br><code>brew install git</code></p>
<p>è®¾ç½®Gitè´¦æˆ·åŠé‚®ç®±ï¼š<br>1ã€è®¾ç½®å…¨å±€è´¦æˆ·åŠé‚®ç®±<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ git config --global user.name luohs</div><div class="line">$ git config --global user.email luohs@example.com</div></pre></td></tr></table></figure></p>
<p>ä¿®æ”¹é…ç½®åï¼Œå¯ä»¥æŸ¥çœ‹æœ¬åœ°gité…ç½®æ–‡ä»¶ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ cat ~/.gitconfig</div><div class="line">[user]</div><div class="line">    name = luohs</div><div class="line">    email = luohs@example.com</div></pre></td></tr></table></figure></p>
<p><img src="/images/20170527/gitconfig.png" alt=""><br>2ã€å–æ¶ˆå…¨å±€é…ç½®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ git config --global --unset user.name</div><div class="line">$ git config --global --unset user.email</div></pre></td></tr></table></figure></p>
<p>åˆ›å»ºæœ¬åœ°SSHï¼š<br>æŸ¥çœ‹æœ¬åœ°æ˜¯å¦å·²ç»åˆ›å»ºrsa,å¦‚æœå­˜åœ¨id_rsaå’Œid_rsa.pubè¯´æ˜å·²ç»åˆ›å»º<br><code>$ ls ~/.ssh</code><br><img src="/images/20170527/id_rsa.png" alt=""><br>ç»ˆç«¯è¾“å…¥<code>ssh-keygen -t rsa -C &quot;luohs@example.com&quot;</code><br>â€œ~/.sshâ€ä¸å­˜åœ¨id_rsaå’Œid_rsa.pubæ—¶ï¼š<br><img src="/images/20170527/create_rsa.png" alt=""><br>â€œ~/.sshâ€å·²å­˜åœ¨id_rsaå’Œid_rsa.pubæ—¶ï¼š<br><img src="/images/20170527/create_rsa_exist.png" alt=""><br>è·¯å¾„é€‰æ‹© : ä½¿ç”¨è¯¥å‘½ä»¤ä¹‹å, ä¼šå‡ºç°æç¤ºé€‰æ‹©ssh-keyç”Ÿæˆè·¯å¾„, è¿™é‡Œç›´æ¥ç‚¹å›è½¦é»˜è®¤å³å¯, ç”Ÿæˆçš„ssh-keyåœ¨é»˜è®¤è·¯å¾„ä¸­(~/.ssh)ã€‚<br>å¯†ç ç¡®è®¤ : è¿™é‡Œæˆ‘ä»¬ä¸ä½¿ç”¨å¯†ç è¿›è¡Œç™»å½•, ç”¨å¯†ç å¤ªéº»çƒ¦;å°±ä¸€è·¯å›è½¦ä¸‹å»ã€‚</p>
<p>SSHé…ç½®åˆ°GitHubï¼š<br>ç™»å½•åˆ°GitHubï¼Œè¿›å…¥settingï¼Œé€‰ä¸­SSHï¼š<br><img src="/images/20170527/ssh_remote.png" alt=""></p>
<p>éªŒè¯ï¼š<br><code>ssh -T git@github.com</code><br><img src="/images/20170527/ssh_verify.png" alt=""></p>
<p>å‚è€ƒï¼š<br><a href="http://gitref.org/zh/index.html" target="_blank" rel="external">http://gitref.org/zh/index.html</a><br><a href="https://git-scm.com/book/zh/v1/èµ·æ­¥" target="_blank" rel="external">https://git-scm.com/book/zh/v1/èµ·æ­¥</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/22/20170522/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="èŠ±ç”Ÿ-sniper">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸‰å‘³çŒªå±‹">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸‰å‘³çŒªå±‹" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/22/20170522/" itemprop="url">
                  Why shouldn't use accessors in init/dealloc?
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-05-22T08:35:45+08:00">
                2017-05-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><p><img src="/images/20170522/accessorMethodTips.png" alt=""><br>å…¶å®ä¹Ÿå¹¶ä¸æ˜¯ä¸€åˆ€åˆ‡ï¼Œæ‰€æœ‰çš„accessoréƒ½ä¸èƒ½åœ¨initå’Œdeallocä¸­ä½¿ç”¨ï¼Œåªæœ‰åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶æ—¶æ‰ä¼šæœ‰é—®é¢˜ï¼š<br>ç¬¬ä¸€ï¼šçˆ¶ç±»init/deallocä½¿ç”¨setterã€‚<br>ç¬¬äºŒï¼šå­ç±»é‡å†™äº†çˆ¶ç±»çš„setterã€‚<br>å¦‚æœçˆ¶ç±»çš„initä¸­è°ƒç”¨äº†æŸä¸ªå±æ€§çš„setteræ–¹æ³•ï¼Œå½“é€šè¿‡self=[super init]å¯¹å­ç±»è¿›è¡Œåˆå§‹åŒ–çš„æ—¶å€™ï¼Œæ­¤æ—¶ä¼šä¼˜å…ˆè°ƒç”¨è°ƒç”¨çˆ¶ç±»çš„initæ–¹æ³•ï¼Œå½“æ‰§è¡Œçˆ¶ç±»çš„initæ–¹æ³•æ—¶ï¼Œçˆ¶ç±»initæ–¹æ³•è°ƒç”¨äº†æŸä¸ªå±æ€§çš„setteræ–¹æ³•ï¼Œç”±äºé¢å‘å¯¹è±¡çš„å¤šæ€ç‰¹æ€§å°±ä¼šè°ƒç”¨å­ç±»é‡å†™äº†çˆ¶ç±»çš„é‚£ä¸ªsetteræ–¹æ³•ï¼Œä½†æ˜¯æ­¤æ—¶å­ç±»è¿˜æœªåˆå§‹åŒ–ï¼Œæ‰€æœ‰å°±ä¼šå‡ºç°é—®é¢˜ã€‚<br>åŒç†ï¼Œå½“çˆ¶ç±»è¿›è¡Œdeallocæ—¶ï¼Œæ­¤æ—¶ä¼šä¼˜å…ˆè°ƒç”¨å­ç±»çš„deallocæ–¹æ³•ï¼Œå¦‚æœçˆ¶ç±»åœ¨deallocæ—¶è°ƒç”¨äº†setterå¹¶ä¸”è¯¥setterè¢«å­ç±»é‡å†™ï¼ŒåŒæ ·ç”±äºé¢å‘å¯¹è±¡çš„å¤šæ€æ€§å°±ä¼šè°ƒç”¨åˆ°å­ç±»çš„setterã€‚è€Œæ­¤æ—¶å­ç±»çš„deallocå·²ç»è¢«è°ƒç”¨äº†ï¼Œé‚£ä¹ˆå†æ‰§è¡Œå­ç±»çš„ä»£ç å°±ä¼šå‡ºç°é—®é¢˜ã€‚</p>
<p>å‚è€ƒï¼š<br><a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmPractical.html#//apple_ref/doc/uid/TP40004447-SW5" target="_blank" rel="external">https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmPractical.html#//apple_ref/doc/uid/TP40004447-SW5</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/19/20170519/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="èŠ±ç”Ÿ-sniper">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸‰å‘³çŒªå±‹">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸‰å‘³çŒªå±‹" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/19/20170519/" itemprop="url">
                  å¦‚ä½•è®¾ç½®å¯¼èˆªæ è¿”å›æŒ‰é’®çš„äº‹ä»¶
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-05-19T14:16:13+08:00">
                2017-05-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><p>è¯´åˆ°è®¾ç½®å¯¼èˆªæ è¿”å›æŒ‰é’®äº‹ä»¶ï¼Œé¦–å…ˆæƒ³åˆ°æ˜¯è®¾ç½®self.navigationItem.leftBarButtonItemã€‚ä½†æ˜¯leftBarButtonItemä¸ç³»ç»Ÿè‡ªå¸¦çš„backBarButtonItemåœ¨æ ·å¼å’Œframeæ˜¯ä¸ä¸€æ ·çš„ï¼Œç‰¹åˆ«æ˜¯APPå¦‚æœæ²¡æœ‰ä»æ•´ä¸ªæ¡†æ¶å±‚å»ç»Ÿä¸€å¯¼èˆªæ çš„è¿”å›æŒ‰é’®ï¼Œå°±ä¼šå‡ºç°æœ‰çš„é¡µé¢æ˜¯ç³»ç»Ÿè‡ªå¸¦çš„backBarButtonItemï¼Œæœ‰çš„é¡µé¢æ˜¯ç¨‹åºå‘˜è®¾ç½®çš„leftBarButtonItemï¼Œå¯¼è‡´ç•Œé¢æ— ä¸€è‡´æ€§ã€‚<br>å…¶å®å¯ä»¥é€šè¿‡UINavigationBarDelegateæä¾›çš„æ–¹æ³•æ¥è®¾ç½®æˆ‘ä»¬è‡ªå®šä¹‰äº‹ä»¶ã€‚<br><img src="/images/20170519/UINavigationBarDelegate.png" alt=""><br>æˆ‘ä»¬å¯ä»¥ä¸ºUINavigatonControlleråˆ›å»ºä¸€ä¸ªç±»åˆ«(Category)æ¥å®šåˆ¶navigationBar: shouldPopItem:çš„é€»è¾‘ã€‚ç”±äºUINavigatonControllerè‡ªå¸¦çš„ UINavigationBarçš„delegateå°±æ˜¯UINavigatonControlleræœ¬èº«ï¼Œæ‰€ä»¥åœ¨åˆ›å»ºå¯¼èˆªæ çš„å®ä¾‹æ—¶ä¸éœ€è¦æ‰‹åŠ¨å»è®¾ç½®delegateã€‚<br>ä»£ç å¦‚ä¸‹ï¼š<br><img src="/images/20170519/UIViewControllerNavigationBarButtonDelegate_2.png" alt=""><br><a href="https://github.com/onegray/UIViewController-BackButtonHandler" target="_blank" rel="external">UIViewController-BackButtonHandler</a>å®ç°å¦‚ä¸‹ï¼š<br><img src="/images/20170519/UIViewControllerNavigationBarButtonDelegate.png" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/18/UIViewä¸­ä½¿ç”¨KVOçš„æ­£ç¡®æ–¹å¼/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="èŠ±ç”Ÿ-sniper">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ä¸‰å‘³çŒªå±‹">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ä¸‰å‘³çŒªå±‹" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/05/18/UIViewä¸­ä½¿ç”¨KVOçš„æ­£ç¡®æ–¹å¼/" itemprop="url">
                  UIViewä¸­ä½¿ç”¨KVOçš„æ­£ç¡®ä½¿ç”¨å§¿åŠ¿
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-05-18T19:05:31+08:00">
                2017-05-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><script src="/assets/js/DPlayer.min.js"> </script><p>ç›¸ä¿¡å¤§å®¶å¯¹äºKVOçš„ä½¿ç”¨åº”è¯¥ä¸ä¼šå­˜åœ¨ä»€ä¹ˆç–‘é—®ï¼ŒaddObserver:forKeyPath:options:context:ä¸removeObserver:forKeyPath:context:å¿…é¡»æˆå¯¹å‡ºç°ã€‚<br><img src="/images/UIViewä¸­ä½¿ç”¨KVOçš„æ­£ç¡®æ–¹å¼/KVO_remove.png" alt=""><br>æŒ‰ç…§å®˜æ–¹æ–‡æ¡£ä¸­æè¿°ï¼ŒObserverï¼ˆè§‚å¯Ÿè€…ï¼‰åœ¨è¢«é‡Šæ”¾æ—¶æ˜¯ä¸ä¼šè‡ªåŠ¨ç§»é™¤çš„ï¼Œè¢«è§‚å¯Ÿçš„å¯¹è±¡ä¼šç»§ç»­å‘é€é€šçŸ¥è€Œæ˜¯ä¸ä¼šå»æ£€æŸ¥ Observerï¼ˆè§‚å¯Ÿè€…ï¼‰çš„çŠ¶æ€çš„ï¼Œå½“å‘é€ç»™ä¸€ä¸ªè¢«é‡Šæ”¾çš„ Observerï¼ˆè§‚å¯Ÿè€…ï¼‰æ—¶å†…å­˜å°±ä¼šå‡ºç°å¼‚å¸¸ã€‚æ‰€ä»¥ç”±æ­¤å¯ä»¥æ¨æ–­ Observerï¼ˆè§‚å¯Ÿè€…ï¼‰åœ¨è°ƒç”¨addObserver:forKeyPath:options:context:æ³¨å†Œæ—¶ä¸æ˜¯è¢«å¼ºå¼•ç”¨çš„ã€‚<br>æŒ‰ç…§å®˜æ–¹æ–‡æ¡£ä¸­æè¿°ï¼ŒObserverï¼ˆè§‚å¯Ÿè€…ï¼‰é€šå¸¸æƒ…å†µä¸‹æ˜¯åœ¨initæˆ–è€…viewDidLoadæ—¶æ³¨å†Œï¼Œåœ¨deallocæ—¶ç§»é™¤ã€‚<br>æ‰€ä»¥åœ¨UIViewæˆ‘ä»¬ä¼šç»å¸¸åœ¨initè¿›è¡Œæ³¨å†Œï¼Œåœ¨deallocæ—¶è¿›è¡Œæ³¨å†Œã€‚è¿™æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œå› ä¸ºè‹¹æœå®˜æ–¹æ–‡æ¡£ä¹Ÿè¿™ä¹ˆè¯´çš„ï¼Œä½†æ˜¯æ€»æ˜¯æ„Ÿè§‰æœ‰ç‚¹ä¸å¥½ï¼Œèƒ½ä¸èƒ½åƒUIViewControlleré‚£æ ·ï¼Œé€šè¿‡ç”Ÿå‘½å‘¨æœŸçš„ç›¸å…³æ¥å£è¿›è¡Œæ³¨å†Œå’Œå–æ¶ˆå‘¢ï¼Ÿ<br>è´Ÿè´£UIViewçš„ç”Ÿå‘½å‘¨æœŸçš„æ¥å£æœ‰ï¼š<br><img src="/images/UIViewä¸­ä½¿ç”¨KVOçš„æ­£ç¡®æ–¹å¼/UIViewHierarchy.png" alt=""><br>UIViewç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š<br>æœªæ·»åŠ subViewï¼š<br>push:willMoveToSuperview-&gt;didMoveToSuperview-&gt;willMoveToWindow-&gt;didMoveToWindow-&gt;layoutSubviews<br>pop:-&gt;willMoveToWindow-&gt;didMoveToWindow-&gt;willMoveToSuperview-&gt;didMoveToSuperview-&gt;removeFromSuperview-&gt;dealloc<br>æ·»åŠ subViewï¼š<br>push:willMoveToSuperview-&gt;didMoveToSuperview-&gt;willMoveToWindow-&gt;didMoveToWindow-&gt;layoutSubviews-&gt;didAddSubview-&gt;layoutSubviews<br>pop:-&gt;willMoveToWindow-&gt;didMoveToWindow-&gt;willMoveToSuperview-&gt;didMoveToSuperview-&gt;removeFromSuperview-&gt;dealloc-&gt;willRemoveSubview<br>å¦‚æœåœ¨UIViewä¸­å®ç°subViewçš„KVOï¼Œé‚£ä¹ˆå¯ä»¥åœ¨didAddSubviewä¸­æ³¨å†Œï¼Œåœ¨willRemoveSubviewä¸­å–æ¶ˆã€‚<br>å¦‚æœåœ¨UIViewä¸­å®ç°è‡ªå·±çš„KVOï¼Œæ‰¾åˆ°çœ¼çä¹Ÿæ²¡æœ‰æ‰¾åˆ°removeFromSuperviewç­‰å­—çœ¼ï¼ŒçœŸæ˜¯å¤±æœ›é€é¡¶ï¼Œä½†æ˜¯å¤§å®¶æœ‰æ²¡æœ‰å‘ç°ï¼Œåœ¨UIViewç”Ÿå‘½å‘¨æœŸä¸­MoveToSuperviewã€MoveToWindowåœ¨pushå’Œpopéƒ½è°ƒç”¨äº†ï¼Œå…¶ä¸­çš„å¥¥ç§˜å°±åœ¨å‚æ•°ï¼šsuperviewï¼Œå½“pushæ—¶ï¼Œæ˜¯å°†UIViewæ·»åŠ åˆ°superviewï¼Œæ‰€ä»¥å‚æ•°superviewæ˜¯ä¸ä¸ºnilçš„ã€‚å½“popæ—¶ï¼Œæ˜¯å°†UIViewä»superviewä¸­ç§»é™¤ï¼Œæ‰€ä»¥å‚æ•°superviewæ˜¯nilã€‚<br>æ­£ç¡®çš„å§¿åŠ¿ï¼š<br><img src="/images/UIViewä¸­ä½¿ç”¨KVOçš„æ­£ç¡®æ–¹å¼/KVO.png" alt=""><br>å‚è€ƒï¼š<br><a href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/KeyValueObserving/Articles/KVOBasics.html#//apple_ref/doc/uid/20002252-178612" target="_blank" rel="external">https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/KeyValueObserving/Articles/KVOBasics.html#//apple_ref/doc/uid/20002252-178612</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="èŠ±ç”Ÿ-sniper" />
          <p class="site-author-name" itemprop="name">èŠ±ç”Ÿ-sniper</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">25</span>
              <span class="site-state-item-name">æ—¥å¿—</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">åˆ†ç±»</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">èŠ±ç”Ÿ-sniper</span>
</div>


<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	




  
  

  

  

  

  


</body>
</html>
